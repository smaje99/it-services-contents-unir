---
import { getCollection } from 'astro:content';
import { Icon } from 'astro-icon/components';

import CourseGrid from '@/components/course/CourseGrid.astro';
import CourseInfo from '@/components/course/CourseInfo.astro';
import SupplementCard from '@/components/supplement/SupplementCard.astro';
import SupplementModal from '@/components/supplement/SupplementModal.astro';
import HomeLayout from '@/layouts/HomeLayout.astro';

const supplements = (await getCollection('supplements')).sort(
  (a, b) => a.data.order - b.data.order,
);
const renderedSupplements = await Promise.all(
  supplements.map(async (entry) => {
    const { Content } = await entry.render();
    return { data: entry.data, Content };
  }),
);
---

<!-- Below is your "component template." It's just HTML, but with
    some magic sprinkled in to help you build great templates. -->
<HomeLayout
  title='Proyecto de Aula - Servicios de Tecnología de la Información'
  description={'Proyecto de aula de la asignatura Servicios de Tecnología de la ' +
    'Información de la carrera Ingeniería Informática en la Fundación Universitaria ' +
    'Internacional de La Rioja (UNIR).'}
>
  <h3 data-heading='icon'>
    <Icon name='graduation-cap' />Bienvenido al Proyecto de Aula
  </h3>
  <p>
    {/* eslint-disable-next-line prettier/prettier */}
    Este proyecto de aula funciona como <strong>material complementario</strong> a las
    clases presenciales, organizado en <strong>3 secciones principales</strong> que
    facilitan el aprendizaje y la evaluación.
  </p>

  <CourseGrid>
    {supplements.map(({ data }) => <SupplementCard {...data} />)}
  </CourseGrid>

  <CourseInfo
    courseName='Servicios de Tecnología de la Información'
    academicProgram='Ingeniería Informática'
    modality='Proyecto de aula complementario'
    durationInWeeks={9}
  />

  {
    renderedSupplements.map(({ data, Content }) => (
      <SupplementModal
        title={data.title}
        description={data.description}
        icon={data.icon}
        iconBg={data.iconBg}
        triggerId={data.triggerId}
      >
        <Content />
      </SupplementModal>
    ))
  }
</HomeLayout>

<style>
  p {
    text-wrap: wrap;
  }
</style>
